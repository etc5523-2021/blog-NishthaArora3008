---
title: "Covid-19 Analysis: Afghanistan"
description: "This blog contains an analysis on the no. of cases and deaths in the year 2021 for Afghanistan and a comparison of these numbers with the time in the first half and the second half of the year i.e. before and during the on-going crises in Afghanistan."
date: "`r Sys.Date()`"
output:
  distill::distill_article:
    toc: true
    toc_depth: 2
---

## Introduction

Afghanistan is a country located in the south-central Asia. The country has been under a continuous conflict for 40 years and is again at war in 2021 itself. Before this it has been struggling with drought, hunger and along with it, the coronavirus disease (COVID-19) as well (Ghai, 2021).

```{r, echo = F, out.width = '70%', fig.align='center'}
knitr::include_graphics("images/flag.png")
```

Below, the analysis is focused on the COVID-19 numbers (cases and deaths) and its relation with the on-going crises.

```{r loadinglibraries, echo=FALSE}
library(readr)
library(tidyverse)
library(lubridate)
library(kableExtra)
library(arsenal) 
library(gt)
library(sparkline)
library(DT)
library(formattable)
```

## Data Description

```{r loadingdata, echo=FALSE}
Afghan_data <- read_csv(here::here(("data/WHO-COVID-19-global-data.csv"))) %>% 
  select(Date_reported, Country, New_cases,	Cumulative_cases,	New_deaths,	Cumulative_deaths) %>% 
  filter(Country == "Afghanistan") %>%
  mutate(Year = year(Date_reported),
         Month= month(Date_reported)) %>% 
  filter(Year == "2021") %>% 
  select(-c(Date_reported))
```


### Data Source

The data set used in this blog has been extracted from [World Health Organization-WHO](https://covid19.who.int/info/). Which was in-turn collected by WHO via different sources. Till 21 March'20, WHO collected these numbers via official ministries of health websites, social media and through official communications under the International Health Regulations-IHR, 2005. From 22 March'20, WHO collected data through WHO dashboards and counts declared at the WHO headquarters regularly (WHO Coronavirus (COVID-19) Dashboard, 2021).

### Variable description

The data set contains the data from January'20 to December'21. The variables used in the analysis are given below with their description and variable type: 

```{r identifyingtypes, include=FALSE}
str(Afghan_data)
```

```{r desc, echo=FALSE}
Desc <- data.frame(Variables = names(Afghan_data),
                          Description = c("Country - Afghanistan",
                                          "New COVID-19 cases, calculated by subtracting 'previous total cases before the date' from 'current total cases till date'",
                                          "Total COVID-19 cases till date",
                                          "New COVID-19 deaths, calculated by subtracting 'previous total deaths before the date' from 'current total deaths till date'",
                                          "Total COVID-19 deaths till date",
                                          "Year of reporting to WHO",
                                          "Month of reporting to WHO"
                                        
                                          ),
                   Type = c("character",
                            "numeric",
                            "numeric",
                            "numeric",
                            "numeric",
                            "numeric",
                            "numeric"))

kbl(Desc) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

## Analysis

### Data Information Display

The table below displays the mean, SD (Standard deviation) and range of the numeric variables.

```{r, echo= FALSE,results='asis'}
variables <- c("New Cases", "New deaths", "Total cases", "Total deaths")
min <- c(min(Afghan_data$New_cases), 
           min(Afghan_data$New_deaths),
           min(Afghan_data$Cumulative_cases),
           min(Afghan_data$Cumulative_deaths))
max <- c(max(Afghan_data$New_cases), 
           max(Afghan_data$New_deaths),
           max(Afghan_data$Cumulative_cases),
           max(Afghan_data$Cumulative_deaths))
mean <- c(round(mean(Afghan_data$New_cases),2), 
           round(mean(Afghan_data$New_deaths),2),
           round(mean(Afghan_data$Cumulative_cases),2),
           round(mean(Afghan_data$Cumulative_deaths),2))
sd <-c(round(sd(Afghan_data$New_cases),2), 
           round(sd(Afghan_data$New_deaths),2),
           round(sd(Afghan_data$Cumulative_cases),2),
           round(sd(Afghan_data$Cumulative_deaths),2))
description <- data.frame(variables, min, max, mean, sd)
DT::datatable(description, options = list(pageLength = 4))
```



### Analysis Communicaion



```{r}

TO <- Afghan_data %>% 
  group_by(Month) %>% 
  summarise(
            Sum_deaths = sum(New_deaths),
            Sum_cases = sum(New_cases),
            Deaths = spk_chr(New_deaths, type = "bar")) %>% 
 datatable(escape = FALSE,
            options = list(fnDrawCallback = htmlwidgets::JS('function(){HTMLWidgets.staticRender();}'))) %>% 
  spk_add_deps()
TO

```
```{r comm, echo=FALSE}
TO <- Afghan_data %>% 
  filter(Month %in% c("1","2","3","4")) %>% 
  group_by(Month) %>% 
  summarise(New_cases = sum(New_cases),
            New_deaths = sum(New_deaths)) 
gt(TO) %>% 
  tab_header(title = "Monthly trend of new cases and deaths in 2021",
           subtitle = "for Jan, Feb, March, April") %>% 
tab_source_note(md("Source: World Health Organization")) %>% 
  cols_label(
  Month = html("Month<br>Year 2021"),
  New_cases = html("Mean value of Cases<br>(per month)"),
  New_deaths = html("Mean value of deaths<br>(per month)")
  )
```
```{r}
 
TT <- Afghan_data %>% 
  group_by(Month) %>% 
  summarise(New_cases = sum(New_cases),
            New_deaths = sum(New_deaths)) %>% 
  filter(Month %in% c("5","6","7","8")) %>% 
  as.data.frame() %>%
  formattable(list(area(col = 2:3) ~ color_tile("#F5B7B1", "#7DCEA0")))
TT
```


## References

Covid19.who.int. 2021. WHO Coronavirus (COVID-19) Dashboard. [online] Available at: <https://covid19.who.int/info/> [Accessed 1 September 2021].

Ghai, R., 2021. Taliban take-over: Afghanistan already battling drought, hunger, COVID-19. DownToEarth, [online]. URL: https://www.downtoearth.org.in/news/governance/taliban-take-over-afghanistan-already-battling-drought-hunger-covid-19-78475 [Accessed 1 September 2021].


